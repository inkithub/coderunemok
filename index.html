<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeRunner</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* General Styles */
        body {
            margin: 0;
            padding: 0;
            font-family: "Arial", sans-serif;
            background-color: #1e1e2f;
            color: #f1f1f1;
            overflow: hidden;
        }

        /* Intro Screen */
        #intro {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #344955;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            animation: fadeIn 2s forwards;
            z-index: 10;
        }
        #intro h1 {
            color: #f9aa33;
            font-size: 48px;
            animation: slideIn 1.5s forwards;
        }
        @keyframes fadeIn { 0% { opacity: 0; } 100% { opacity: 1; } }
        @keyframes slideIn { 0% { transform: translateY(-50px); } 100% { transform: translateY(0); } }

        /* Floating Action Buttons (FABs) */
        .fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #f9aa33;
            color: #1e1e2f;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
        }
        .fab:hover {
            transform: scale(1.1);
            background-color: #f69d28;
        }
        /* Bounce animation for button click */
        .fab:active {
            animation: bounce 0.3s;
        }
        @keyframes bounce {
            0% { transform: scale(1); }
            50% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        /* Grid Layout */
        #wrapper {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 20px;
            height: calc(100vh - 60px);
            transition: all 0.3s ease-in-out;
        }

        /* Code Container */
        .codeContainer {
            padding: 20px;
            box-sizing: border-box;
            border-radius: 10px;
            background: #2b2b3d;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            position: relative;
            color: #e0e0e0;
            font-weight: bold;
            font-size: 14px;
        }
        .codeContainer textarea {
            width: 100%;
            height: calc(100% - 30px);
            background: #1e1e2f;
            border: 1px solid #3c3c4e;
            color: #f1f1f1;
            border-radius: 8px;
            font-family: Courier, monospace;
            font-size: 14px;
            padding: 10px;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
        }
        .codeContainer textarea:focus {
            border-color: #f9aa33;
            box-shadow: 0 0 5px #f9aa33;
        }
        iframe {
            height: 100%;
            width: 100%;
            border: 1px solid #3c3c4e;
            border-radius: 8px;
            background: #1e1e2f;
            color: #f1f1f1;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }

        /* Line Counter */
        .lineCounter {
            position: absolute;
            bottom: 10px;
            right: 20px;
            color: #f9aa33;
            font-size: 12px;
        }

        /* Loading Animation */
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            z-index: 20;
        }
        .loader {
            width: 40px;
            height: 40px;
            border: 4px solid #f1f1f1;
            border-top: 4px solid #f9aa33;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error Message */
        #errorMessage {
            display: none;
            color: #ff6b6b;
            font-weight: bold;
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 30;
        }

    </style>
</head>
<body>

<!-- Intro Screen -->
<div id="intro">
    <h1>Welcome to CodeRunner!</h1>
</div>

<div id="wrapper" style="display: none;">
    <div class="codeContainer" id="HTMLContainer">
        <div class="codeLabel">HTML</div>
        <textarea id="htmlCode">Write your HTML code here...</textarea>
        <div class="lineCounter" id="htmlLineCounter">Lines: 1</div>
    </div>
    
    <div class="codeContainer" id="CSSContainer">
        <div class="codeLabel">CSS</div>
        <textarea id="cssCode">Write your CSS code here...</textarea>
        <div class="lineCounter" id="cssLineCounter">Lines: 1</div>
    </div>
    
    <div class="codeContainer" id="JSContainer">
        <div class="codeLabel">JavaScript</div>
        <textarea id="jsCode">Write your JavaScript code here...</textarea>
        <div class="lineCounter" id="jsLineCounter">Lines: 1</div>
    </div>

    <div class="codeContainer" id="ResultContainer">
        <div class="codeLabel">Result</div>
        <iframe id="resultFrame" src="" frameborder="0"></iframe>
    </div>
</div>

<!-- Loading Animation -->
<div id="loading">
    <div class="loader"></div>
</div>

<!-- Error Message -->
<div id="errorMessage"></div>

<!-- Floating Action Buttons -->
<button class="fab" id="runButton">Run</button>
<button class="fab" id="downloadButton" style="bottom: 90px;">Save</button>

<script>
    $(document).ready(function() {
        // Intro animation
        setTimeout(function() {
            $("#intro").fadeOut(1000, function() {
                $("#wrapper").fadeIn(1000);
            });
        }, 2000);

        // Update line counter function
        function updateLineCount(textareaId, counterId) {
            var lineCount = $("#" + textareaId).val().split("\n").length;
            $("#" + counterId).text("Lines: " + lineCount);
        }

        // Attach keyup event for line counting
        $("#htmlCode").on('input', function() { updateLineCount("htmlCode", "htmlLineCounter"); });
        $("#cssCode").on('input', function() { updateLineCount("cssCode", "cssLineCounter"); });
        $("#jsCode").on('input', function() { updateLineCount("jsCode", "jsLineCounter"); });

        // Initialize line counters
        updateLineCount("htmlCode", "htmlLineCounter");
        updateLineCount("cssCode", "cssLineCounter");
        updateLineCount("jsCode", "jsLineCounter");

        // Run code and show loading animation
        $("#runButton").click(function() {
            $("#loading").show();
            $("#errorMessage").hide();
            try {
                var htmlContent = $("#htmlCode").val();
                var cssContent = $("#cssCode").val();
                var jsContent = $("#jsCode").val();
                var fullContent = `<style>${cssContent}</style>${htmlContent}<script>${jsContent}<\/script>`;
                $("#resultFrame").contents().find("html").html(fullContent);
            } catch (error) {
                $("#errorMessage").text("Error: " + error.message).fadeIn();
            } finally {
                $("#loading").hide();
            }
        });

        // Download file with watermark
        $("#downloadButton").click(function() {
            var htmlContent = $("#htmlCode").val();
            var cssContent = $("#cssCode").val();
            var jsContent = $("#jsCode").val();
            var watermark = "\n\n/* Watermarked Download */\n";

            var codeContent = `HTML:\n${htmlContent}\n\nCSS:\n${cssContent}\n\nJavaScript:\n${jsContent}${watermark}`;

            var blob = new Blob([codeContent], { type: 'text/plain' });
            var url = URL.createObjectURL(blob);
            var a = document.createElement('a');
            a.href = url;
            a.download = 'coderunner.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });
    });
</script>

</body>
</html>
